## Gamma 입력용 PPT 초안 (Rule-Engine 심화 분석)

슬라이드 1: 표지
제목: GTRPGM Rule-Engine 설계 및 구현

부제: LLM 환경에서의 데이터 무결성 보장 및 규칙 제어 시스템

담당 파트: 데이터베이스 설계, 엔진 로직 구축
---
슬라이드 2: Rule-Engine의 역할 (Role)
목적: LLM이 생성하는 서사를 게임적 규칙(Rule) 내에 바인딩하는 '규칙 통제 센터'

핵심 기능: * 비정형 텍스트 기반 시나리오를 정형 데이터로 치환

캐릭터 능력치, 아이템 효과, 전투 확률 등 수치 연산 및 검증

모든 게임 내 이벤트를 추적 가능한 로그로 변환
---
슬라이드 3: DB 설계 전략 (Entity-Relationship)
도메인 기반 모듈화: 17개 이상의 테이블을 4개 도메인(캐릭터, 개체, 경제, 로그)으로 분할 설계

동적 환경 보정: world_eras와 world_locales를 결합하여 시간/공간에 따른 난이도 가중치(stat_modifier)를 동적으로 계산하는 로직 구현

유연한 확장성: 신규 아이템(items)이나 몬스터(enemies) 추가 시 코드 수정 없이 데이터 삽입만으로 엔진 반영
---
슬라이드 4: LLM 최적화 성격 엔진 (NPC Personality)
문제: LLM의 일관성 없는 말투와 성격 설정의 어려움

해결: personality 테이블 구축

성격을 카테고리별(Emotion, Hobby 등)로 정규화

opposite 필드(배열 형태)를 통해 상충하는 성격이 동시에 부여되지 않도록 제어

성과: LLM 프롬프트 생성 시 정교한 성격 매개변수 제공 가능
---
슬라이드 5: 하이라이트: Play Log & State Snapshot
기술적 엣지: play_logs 테이블의 jsonb 필드 활용

구현 내용: * state_diff: 한 턴의 행동이 미친 수치적 변화량 기록

world_snapshot: 특정 시점의 전체 세계관 데이터 저장

이점: 게임 중단 시 턴 단위의 완벽한 롤백(Rollback) 및 세션 복구 메커니즘 확보
---
슬라이드 6: 시스템 상수 및 밸런싱 제어
system_configs 테이블: 게임의 초기값(HP_START 등)을 하드코딩하지 않고 관리자 페이지나 DB에서 즉시 튜닝 가능하도록 설계

이점: 엔진 재빌드 없이 게임 밸런스를 실시간으로 조정할 수 있는 운영 편의성 확보
---
슬라이드 7: 구현 이슈 및 트러블슈팅
이슈: 다수의 테이블 참조로 인한 쿼리 복잡도 증가

해결: * 인덱스 최적화(idx_play_logs_hierarchy 등)를 통해 계층적 로그 탐색 성능 개선

자주 쓰이는 정적 데이터와 휘발성 로그 데이터의 저장 전략 이원화
---
슬라이드 8: 담당 부분 요약 및 기여도
설계 측면: 확장 가능한 관계형 데이터 구조 확립 (100% 기여)

데이터 신뢰성: JSONB 기반 로그 추적 시스템을 통해 AI의 환각(Hallucination) 방지 기틀 마련

인터페이스: 타 모듈(LLM 모듈)이 데이터를 쉽게 읽어갈 수 있도록 뷰(View) 및 규격 정의